<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>2025/07 ç¦åº·æ´»å‹•-å¤§æš‘åƒå¤§è–¯</title>
    <link rel="shortcut icon" type="image/x-icon" href="../../public/TAKO.ico">
    <link rel="stylesheet icon" type="text/css" href="../../public/easyui/metro-orange/easyui.css">
    <link rel="stylesheet icon" type="text/css" href="../../public/bootstrap/bootstrap.min.css">
    <link rel="stylesheet icon" type="text/css" href="../../public/bootstrap/bootstrap-icons.min.css">
    <link rel="stylesheet icon" type="text/css" href="../../public/sweetalert/sweetalert2.min.css">
    <link rel="stylesheet icon" type="text/css" href="../../public/daterangepicker/daterangepicker.css">
    <link rel="stylesheet icon" type="text/css" href="../../public/main/main.css">
    <style>
        body {
            margin: 0;
            font-family: 'Segoe UI', sans-serif;
            background: #fff;
            color: #333;
            font-family: 'Noto Sans CJK TC', sans-serif; /* You might need to import a suitable Chinese font */
        }

        .container {
            max-width: 1000px;
            margin: auto;
            padding: 40px 20px;
            text-align: center;
        }

        h1 {
            font-size: 3em;
            font-weight: bold;
        }

        h1 .highlight {
            color: orange;
        }

        .subtext {
            margin: 10px 0 30px;
            color: #666;
            font-size: 0.95em;
        }

        .order-button {
            background-color: orange;
            color: white;
            border: none;
            padding: 14px 28px;
            font-size: 1em;
            border-radius: 6px;
            cursor: pointer;
        }

        .price-section {
            margin-top: 30px;
            font-size: 1.5em;
            color: orange;
        }

        .stars {
            color: gold;
            margin: 10px 0;
        }

        .features {
            display: flex;
            justify-content: center;
            gap: 40px;
            margin: 40px 0;
            font-size: 0.9em;
            color: #666;
        }

        .features div {
            max-width: 200px;
        }

        .burger-image {
            margin: 40px auto;
            max-width: 500px;
        }

        .burger-image img {
            width: 100%;
            max-width: 100%;
            height: auto;
        }

        .nav-icons {
            display: flex;
            justify-content: space-around;
            margin-top: 60px;
            border-top: 1px solid #eee;
            padding-top: 20px;
        }

        .nav-icons div {
            text-align: center;
            font-size: 0.95em;
            color: #333;
        }

        .nav-icons img {
            height: 36px;
            margin-bottom: 5px;
        }

        .footer {
            font-size: 0.8em;
            color: #999;
            margin-top: 40px;
        }
    </style>
</head>

<body>
    <div class="container">
        <h1><em> <span class="highlight">JULY 22</span> å¤§æš‘åƒå¤§è–¯</em></h1>
        <div class="subtext">
            7/21 åœ‹éš›åƒåœ¾é£Ÿç‰©æ—¥ã€7/22 å¤§æš‘ã€åœ¨å¤§æš‘é€™å¤©åƒå¤§è–¯ï¼Œå¥½å¥½æ„Ÿå—åƒåœ¾é£Ÿç‰©çš„é­…åŠ›ï¼
        </div>

        <div class="burger-image">
            <img src="https://img.lovepik.com/free-png/20220107/lovepik-summer-fast-food-big-fries-png-image_401243349_wh860.png"
                alt="Burger" style="mouse" />
        </div>

        <div class="features">
            <div>
                <strong>NATURE FIRST FOOD</strong><br />
                Rorem ipsum dolor sit amet, etur advoluptatem voluptatem
            </div>
            <div>
                <strong>HEALTHY FOOD</strong><br />
                Rorem ipsum dolor sit amet, etur advoluptatem voluptatem
            </div>
            <div>
                <strong>GREAT LOCATION</strong><br />
                Rorem ipsum dolor sit amet, etur advoluptatem voluptatem
            </div>
        </div>

        <div class="nav-icons">
            <div>
                ğŸ”<br />Burger
            </div>
            <div>
                ğŸ•<br />Pizza
            </div>
            <div>
                ğŸ<br />Bread
            </div>
            <div>
                ğŸ—<br />Chicken
            </div>
            <div>
                ğŸ<br />Pasta
            </div>
            <div>
                ğŸ¥¤<br />Drinks
            </div>
        </div>

        <div class="footer">
            &copy; 2025 Excellent Bugger Food. All rights reserved.
        </div>
    </div>
</body>
<script type="text/javascript" src="../../public/main/main.js"></script>
<script type="text/javascript" src="../../public/easyui/jquery.min.js"></script>
<script type="text/javascript" src="../../public/easyui/jquery.easyui.min.js"></script>
<script type="text/javascript" src="../../public/easyui/locale/easyui-lang-zh_TW.js"></script>
<script type="text/javascript" src="../../public/bootstrap/bootstrap.min.js"></script>
<script type="text/javascript" src="../../public/sweetalert/sweetalert2.min.js"></script>
<script type="text/javascript" src="../../public/daterangepicker/moment.min.js"></script>
<script type="text/javascript" src="../../public/jquery.actual-master/jquery.actual.min.js"></script>
<script type="text/javascript" src="../../public/daterangepicker/daterangepicker.js"></script>
<script type="text/javascript" src="../../public/gas/gas.js"></script>
<script type="text/javascript" src="../../public/animation/anime.min.js"></script>
<script type="text/javascript">
    // åªè¦é‡æ•´å°±æ˜¯è¦é‡æ–°å¡«å–®
    localStorage.clear();
    // å…ˆè·‘å®ŒåŠ è¼‰ï¼Œå†è·‘è‡ªå·±çš„fn
    // è®€å–åœ–ç‰‡
    // $("#logo_drink").attr('src',"../../public/img/20250618/logo_drink.png")
    //-----------------------------------------------------------------------------------------
    // æ¯è¡Œï¼ˆæ¯å€‹ card-groupï¼‰é¡¯ç¤ºçš„å¡ç‰‡æ•¸é‡
    let group_size = 4;
    //-----------------------------------------------------------------------------------------
    // é£Ÿç‰©çš„è®€å–
    //-----------------------------------------------------------------------------------------
    let food_html = ""; // ç”¨æ–¼ç´¯ç©æ‰€æœ‰ card-group çš„ HTML
    // å¤–å±¤è¿´åœˆï¼šæ ¹æ“šæ¯çµ„çš„æ•¸é‡ä¾†è¿­ä»£ï¼Œç”Ÿæˆå¤šå€‹ card-group
    for (let i = 0; i < food_data.length; i += group_size) {
        let current_card_group_html = `<div class="card-group mb-3">`; // ç‚ºæ¯å€‹ card-group å¢åŠ åº•éƒ¨é‚Šè·ï¼Œä½¿å…¶èˆ‡ä¸‹ä¸€çµ„æœ‰é–“éš”
        // å…§å±¤è¿´åœˆï¼šè™•ç†æ¯å€‹ card-group ä¸­çš„å¡ç‰‡
        for (let j = 0; j < group_size; j++) {
            let current_index = i + j; // è¨ˆç®—ç•¶å‰å¡ç‰‡çš„ç´¢å¼•
            // æª¢æŸ¥æ˜¯å¦é‚„æœ‰æ•¸æ“šï¼Œé¿å…è¶…å‡º food_data é™£åˆ—çš„ç¯„åœ
            if (current_index < food_data.length) {
                current_card_group_html += `
                            <div class="card h-100"> <img src="` + url + "public/img/20250618/" + food_data[current_index] + `.png" class="card-img-top food-card-img" alt="...">
                                <div class="card-body">
                                    <h5 class="card-title text-center">` + food_data[current_index] + `</h5>
                                    <div class="input-group justify-content-center mt-2 count_qty">
                                        <button class="btn btn-outline-secondary" type="button" onClick="Minus_qty(this,'food')" > - </button>
                                        <input type="text" class="form-control text-center quantity-input" disabled placeholder="" aria-label="æ•¸é‡"  value=0 style="max-width: 60px;" >
                                        <button class="btn btn-outline-secondary plus" type="button" onClick="Plus_qty(this,'food')"> + </button>
                                    </div>
                                </div>
                            </div>
                        `;
            } else {
                // å¦‚æœé€™è¡Œä¸è¶³ group_size å€‹å¡ç‰‡ï¼Œå¯ä»¥ç”¨ç©ºçš„å¡ç‰‡è£œé½Šï¼Œ
                // é€™æ¨£å¯ä»¥è®“ card-group ä¿æŒæ¯åˆ—çš„å¯¬åº¦ä¸€è‡´ã€‚
                // é€™å°æ–¼ card-group å¾ˆé‡è¦ï¼Œå› ç‚ºå®ƒæœƒè‡ªå‹•èª¿æ•´å…§éƒ¨å¡ç‰‡çš„å¯¬åº¦ã€‚
                current_card_group_html += `<div class="card card-placeholder invisible"></div>`; // ä½¿ç”¨ invisible è®“å…¶ä¸é¡¯ç¤ºä½†ä½”æ“šç©ºé–“
            }
        }
        current_card_group_html += `</div>`; // çµæŸç•¶å‰ card-group çš„ div
        food_html += current_card_group_html; // å°‡å®Œæˆçš„ card-group åŠ å…¥ç¸½ HTML å­—ç¬¦ä¸²
    }
    $("#food_cards").append(food_html);
    //-----------------------------------------------------------------------------------------
    // é£²æ–™çš„è®€å–
    //-----------------------------------------------------------------------------------------
    // ç¬¬ä¸€å±¤è¿´åœˆï¼šéæ­·æ¯å€‹é£²æ–™é¡åˆ¥
    var drinkCategories = Object.keys(drink_data);
    var drink_html = "";
    var key = 1;
    for (let i = 0; i < drinkCategories.length; i++) {
        const categoryName = drinkCategories[i];
        const drinksInThisCategory = drink_data[categoryName];
        drink_html += `                  
                                <div class="card drink-category" >
                                    <div class="card-header">
                                        <button class="btn btn-link btn-block text-left" type="button" data-toggle="collapse" data-target="#collapse_${i}" aria-expanded="true" aria-controls="collapseOne">
                                        ã€‰${categoryName}
                                        </button>
                                    </div>
                                    <div id="collapse_${i}" class="collapse" aria-labelledby="headingOne" data-parent="#accordion_drink">
                                    `;
        // å°‡è©²é¡åˆ¥ä¸‹çš„æ‰€æœ‰é£²å“åç¨±è½‰æ›æˆé™£åˆ—ï¼Œæ–¹ä¾¿ä½¿ç”¨ç´¢å¼•é€²è¡Œåˆ†çµ„
        const drinkNamesArray = Object.keys(drinksInThisCategory);
        const cardsPerRow = 4; // æ¯çµ„é¡¯ç¤ºçš„å¡ç‰‡æ•¸é‡
        for (let j = 0; j < drinkNamesArray.length; j++) {
            // æ¯ç•¶ j æ˜¯ cardsPerRow çš„å€æ•¸æ™‚ï¼ˆåŒ…æ‹¬ j=0ï¼‰ï¼Œå°±é–‹å§‹ä¸€å€‹æ–°çš„ card-group
            if (j % cardsPerRow === 0) {
                // å¦‚æœä¸æ˜¯ç¬¬ä¸€å€‹ card-groupï¼Œå…ˆçµæŸå‰ä¸€å€‹
                if (j !== 0) {
                    // **è£œé½Šå‰©é¤˜çš„ä½”ä½å¡ç‰‡**
                    drink_html += `</div>`; // çµæŸä¸Šä¸€å€‹ card-group
                }
                // é–‹å§‹æ–°çš„ card-groupï¼Œä¸¦å¢åŠ åº•éƒ¨é‚Šè·
                drink_html += `<div class="card-group mb-3">`;
            }
            const drinkName = drinkNamesArray[j];
            const drinkDetails = drinksInThisCategory[drinkName];
            drink_html += `
                        <div class="card h-100">
                            <div class="card-body">
                                <h5 class="card-title text-center">${drinkName}</h5>
                                <p class="card-price text-center">åƒ¹æ ¼: NT$${drinkDetails.price}</p>`;
            // æª¢æŸ¥æ˜¯å¦ç”œåº¦å†°å¡Šæ­£å¸¸
            var ice = ['æ­£å¸¸å†°', 'å°‘å†°', 'å»å†°', 'æº«'];
            var sugar = ['æ­£å¸¸ç³–', 'åŠç³–', 'å¾®ç³–', 'ç„¡ç³–'];
            if (drinkDetails.normal_only === 1) {
                drink_html += `<div class="option-group" data-option-type="sugar">
                                            <input type="radio" id="sugar-normal-${key}" name="sugar-option-${key}" value="ç”œåº¦å›ºå®š" class="hidden-radio">
                                            <label for="sugar-normal-${key}" class="option-label-radio">ç”œåº¦å›ºå®š</label>
                                        </div>
                                        <div class="option-group" data-option-type="ice">
                                            <input type="radio" id="ice-normal-${key}" name="ice-option-${key}" value="å†°å¡Šå›ºå®š" class="hidden-radio">
                                            <label for="ice-normal-${key}" class="option-label-radio">å†°å¡Šå›ºå®š</label>
                                        </div>`;
            } else {
                drink_html += `
                                        <div class="option-group" data-option-type="sugar">
                                            <input type="radio" id="sugar-normal-${key}" name="sugar-option-${key}" value="æ­£å¸¸ç³–" class="hidden-radio">
                                            <label for="sugar-normal-${key}" class="option-label-radio">æ­£å¸¸ç³–</label>
                                            <input type="radio" id="sugar-half-${key}" name="sugar-option-${key}" value="åŠç³–" class="hidden-radio">
                                            <label for="sugar-half-${key}" class="option-label-radio">åŠç³–</label>
                                            <input type="radio" id="sugar-slight-${key}" name="sugar-option-${key}" value="å¾®ç³–" class="hidden-radio">
                                            <label for="sugar-slight-${key}" class="option-label-radio">å¾®ç³–</label>
                                            <input type="radio" id="sugar-none-${key}" name="sugar-option-${key}" value="ç„¡ç³–" class="hidden-radio">
                                            <label for="sugar-none-${key}" class="option-label-radio">ç„¡ç³–</label>
                                        </div>
                                        <div class="option-group" data-option-type="ice">`;
                if (drinkDetails.onIy_iced === 1 || drinkDetails.onIy_hot === 0) {
                    drink_html += `    <input type="radio" id="ice-normal-${key}" name="ice-option-${key}" value="æ­£å¸¸å†°" class="hidden-radio">
                                            <label for="ice-normal-${key}" class="option-label-radio">æ­£å¸¸å†°</label>
                                            <input type="radio" id="ice-less-${key}" name="ice-option-${key}" value="å°‘å†°" class="hidden-radio">
                                            <label for="ice-less-${key}" class="option-label-radio">å°‘å†°</label>
                                            <input type="radio" id="ice-no-${key}" name="ice-option-${key}" value="å»å†°" class="hidden-radio">
                                            <label for="ice-no-${key}" class="option-label-radio">å»å†°</label>`;
                } else if (drinkDetails.onIy_hot === 1 || drinkDetails.onIy_iced === 0) {
                    drink_html += `
                                            <input type="radio" id="sugar-none-${key}" name="sugar-option-${key}" value="æº«" class="hidden-radio">
                                            <label for="sugar-none-${key}" class="option-label-radio">æº«</label>`;
                }
                drink_html += ` 
                        </div>
                                    <div class="count_qty"> <div class="input-group justify-content-center mt-2">
                                            <button class="btn btn-outline-secondary add_text" type="button" onClick="Minus_qty(this,'drink')" > - </button>
                                            <input type="text" class="form-control text-center quantity-input" placeholder="" aria-label="æ•¸é‡" value="0" style="max-width: 60px;" id="quantity-input-drink-${key}">
                                            <button class="btn btn-outline-secondary add_text" type="button" onClick="Plus_qty(this,'drink')" > + </button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        `;
            }
            key++;
        }
        // **è¿´åœˆçµæŸå¾Œï¼Œè™•ç†æœ€å¾Œä¸€å€‹ card-group çš„è£œé½Šå•é¡Œ**
        // è¨ˆç®—æœ€å¾Œä¸€å€‹ card-group é‚„å·®å¤šå°‘å€‹å¡ç‰‡
        const remaining_cards = drinkNamesArray.length % cardsPerRow;
        if (remaining_cards !== 0) { // å¦‚æœæœ€å¾Œä¸€è¡Œä¸æ˜¯æ»¿çš„
            const placeholders_to_add = cardsPerRow - remaining_cards;
            for (let k = 0; k < placeholders_to_add; k++) {
                drink_html += `<div class="card card-placeholder"></div>`;
            }
        }
        // ç¢ºä¿æ¯å€‹é¡åˆ¥çš„æœ€å¾Œä¸€å€‹ card-group è¢«æ­£ç¢ºé—œé–‰
        if (drinkNamesArray.length > 0) { // åªæœ‰ç•¶é€™å€‹é¡åˆ¥æœ‰é£²å“æ™‚æ‰éœ€è¦é—œé–‰ card-group
            drink_html += `</div>`; // çµæŸæœ€å¾Œä¸€å€‹ card-group
        }
        drink_html += `</div></div>`; // çµæŸ drink-category
    }
    $("#drink_cards").append(drink_html);
    // å¦‚æœæœ‰åŠ æ¸›é …ç›®ï¼Œå°±æŠŠé¸éçš„å“é …å¯«ä¸Šå»
    $(".add_text").on("click", function () {
        // å…ˆæª¢æŸ¥æ˜¯å¦æœ‰é¸ç”œåº¦å†°å¡Š
        var sugar_ck_comp = $(this).closest('.card').find('input[name^="sugar-option-"]:checked').val();
        var ice_ck_comp = $(this).closest('.card').find('input[name^="ice-option-"]:checked').val();
        if (!sugar_ck_comp || !ice_ck_comp) {
            Swal.fire({
                title: "è«‹å…ˆé¸æ“‡ç”œåº¦å†°å¡Š",
                icon: "warning"
            });
            // æŠŠå€¼æ­¸é›¶
            $(this).siblings("input").val(0);
            return;
        }
        fillinDrinkList();
    })
    //-----------------------------------------------------------------------------------------
    // é‡è£½è¡¨å–®ç‹€æ…‹
    //-----------------------------------------------------------------------------------------
    // ç›£è½æ‰€æœ‰å…·æœ‰ 'modal' é¡åˆ¥çš„å…ƒç´ ï¼Œç•¶å®ƒå€‘è§¸ç™¼ 'hidden.bs.modal' äº‹ä»¶æ™‚
    $('.modal').on('hidden.bs.modal', function () {
        $('.count_qty input[type="text"]').prop('disabled', false); // é–å®šæ‰€æœ‰ count_qty å…§éƒ¨çš„ input
        $('.count_qty input[type="text"]').val(0); // é–å®šæ‰€æœ‰ count_qty å…§éƒ¨çš„ input
        // 2. å±•é–‹ Modal å…§éƒ¨æ‰€æœ‰çš„ Accordion é …ç›®
        // æ‰¾åˆ° Modal å…§éƒ¨æ‰€æœ‰å…·æœ‰ 'accordion-collapse' é¡åˆ¥çš„æ‘ºç–Šå…§å®¹å€å¡Š
        $(this).find('.collapse').each(function () {
            $(this).removeClass("show");
        });
        // æ¸…ç©ºé¸å–çš„ radio
        $('.hidden-radio:checked').each(function (idx, val) {
            $(val).prop("checked", false);
        })
    });
    //-----------------------------------------------------------------------------------------
    // è³¼ç‰©è»Šçš„é–‹å•Ÿ
    //-----------------------------------------------------------------------------------------
    $('#cart_form').on('show.bs.modal', function (event) {
        var total = 0;
        /*---------------------------------------------*/
        // è®€å–åˆ—è¡¨ï¼Œä¸¦ä¾ç…§å»ºç«‹æ™‚é–“å…ˆæ’åº
        /*---------------------------------------------*/
        var form_data = GetGasData("6æœˆè¡¨å–®å›æ‡‰");
        // å°‡è³‡æ–™è½‰åŒ–ç‚ºå¯è®€å–çš„è³‡æ–™
        var [header, ...data] = form_data;
        form_data = data
            .map((row) =>
                header.reduce((acc, key, index) => ({ ...acc, [key]: row[index] }), {})
            );
        const remainingMembers = {};
        const reportedMembersByFloor = {};
        // 1. å»ºç«‹å·²å ±åˆ°äººå“¡çš„å¿«é€ŸæŸ¥æ‰¾çµæ§‹
        // éæ­· form_dataï¼Œå°‡å·²å ±åˆ°çš„äººå“¡æŒ‰æ¨“å±¤æ­¸é¡
        form_data.forEach(person => {
            let floorKey = person.order_floor;
            if (!reportedMembersByFloor[floorKey]) {
                reportedMembersByFloor[floorKey] = new Set(); // ä½¿ç”¨ Set é€²è¡Œé«˜æ•ˆæŸ¥æ‰¾
            }
            reportedMembersByFloor[floorKey].add(person.order_name);
        });
        // 2. éæ­· member_listï¼Œæ‰¾å‡ºæ¯å€‹æ¨“å±¤å‰©é¤˜çš„äºº
        for (const floorKey in member_list) {
            if (member_list.hasOwnProperty(floorKey)) {
                const floorMembers = member_list[floorKey];
                const currentReportedMembers = reportedMembersByFloor[floorKey] || new Set(); // å¦‚æœè©²æ¨“å±¤æ²’æœ‰äººå ±åˆ°ï¼Œå‰‡ç‚ºç©º Set
                const remainingInThisFloor = [];
                floorMembers.forEach(member => {
                    if (!currentReportedMembers.has(member)) {
                        remainingInThisFloor.push(member);
                    }
                });
                remainingMembers[floorKey] = remainingInThisFloor;
            }
        }
        // æ¯”å°ä¸€ä¸‹æ¯å€‹æ¨“å±¤å‰©é¤˜çš„äººæ•¸
        // ä¾ç…§å‰©é¤˜äººæ•¸æº–å‚™ data
        let loadData_floor = [];
        for (let floor in remainingMembers) {
            let data = {};
            data.id = floor;
            data.text = floor;
            loadData_floor.push(data);
        }
        $("#select_floor").combobox({
            required: true,
            editable: false,
            panelHeight: 'auto',
            panelMaxHeight: '335',
            valueField: 'id',
            textField: 'text',
            data: loadData_floor,
            onChange: function (newValue, oldValue) {
                if (newValue !== oldValue) {
                    $("#select_name").combobox("setValue", "");
                    data = remainingMembers[newValue].map((x) => { return { id: x, text: x } });
                }
                $("#select_name").combobox("loadData", data);
                if (newValue == "äºŒæ¨“") {
                    $("#order_list_ul").append(`<tr><td colspan=2 id="budget">å€‹äººé ç®—å‰©é¤˜ï¼š${233 - total}</td></tr>`);
                } else {
                    if ($("#budget").length > 0) {
                        $("#budget").remove();
                    }
                }
            }
        })
        $("#select_name").combobox({
            required: true,
            editable: false,
            panelHeight: 'auto',
            panelMaxHeight: '250',
            valueField: 'id',
            textField: 'text',
            idField: "id",
            textField: "text",
        })
        /*---------------------------------------------*/
        // é»é¤æ¸…å–®
        /*---------------------------------------------*/
        var html_order = `
                <tr>
                    <td class="w-50">é–£æ¨“ä¸Šçš„é¹¹æ´¾</td>
                    <td class="w-50">æ—¥å‡ºèŒ¶å¤ª</td>
                </tr>
                <tr>
                `;
        html_order += `<td class="w-50"> `;
        if (localStorage.getItem("food")) {
            var food_list = JSON.parse(localStorage.getItem("food"));
            food_list.forEach(food => {
                html_order += `
                            <li>
                                <strong>${food.goods}</strong> *${food.qty}
                            </li>
                        `;
            });
            total += 150;
        }
        html_order += `</td> `;
        html_order += `<td class="w-50"> `;
        if (localStorage.getItem("drink")) {
            var drink = JSON.parse(localStorage.getItem("drink"));
            drink.forEach(drink => {
                html_order += `
                            <li>
                                <strong>${drink.goods}</strong> - åƒ¹æ ¼: NT$${drink.price}
                                (ç”œåº¦: ${drink.sugar}, å†°å¡Š: ${drink.iced})
                                æ•¸é‡: ${drink.qty}
                            </li>
                        `;
                total += drink.price;
            });
        }
        html_order += `</td><tr> `;
        // ç¸½å’Œé‡‘é¡
        html_order += `<tr><td colspan="2">ç¸½é‡‘é¡ï¼š${total}</td></tr>`;
        $("#order_list_ul").html(html_order);
    })
    //     }
    // )
    //-----------------------------------------------------------------------------------------
    // ä¸€äº›å¥½ç”¨çš„ function
    //-----------------------------------------------------------------------------------------
    // å¢åŠ æ•¸é‡    
    function Minus_qty(btn, type) {
        var input = $(btn).next('.quantity-input');
        var value = parseInt($(input).val());
        $(input).val(value - 1 < 0 ? 0 : value - 1);
        Sum(type);
    }
    // æ¸›å°‘æ•¸é‡
    function Plus_qty(btn, type) {
        var input = $(btn).prev('.quantity-input');
        var value = parseInt($(input).val());
        $(input).val(value + 1);
        Sum(type);
    }
    // æ¸›å°‘æ•¸é‡
    function Sum(type) {
        // å–å¾—æ‰€æœ‰çš„æ•¸å­—
        let totalQuantity = 0;
        $('.quantity-input').each(function () {
            // å–å¾—æ¯å€‹ input çš„å€¼
            let quantity = parseInt($(this).val()); // ä½¿ç”¨ parseInt å°‡å€¼è½‰æ›ç‚ºæ•´æ•¸
            // æª¢æŸ¥è½‰æ›å¾Œçš„æ•¸å­—æ˜¯å¦æœ‰æ•ˆ (ä¸æ˜¯ NaN)
            if (!isNaN(quantity)) {
                totalQuantity += quantity; // åŠ åˆ°ç¸½å’Œä¸­
            }
        });
        var max_count = {
            "food": 2,
            "drink": 9999,
        };
        if (totalQuantity >= max_count[type]) {
            // å¦‚æœç¸½å’Œé”åˆ°æˆ–è¶…éä¸Šé™ï¼Œé–å®šæ‰€æœ‰ç›¸é—œæ§ä»¶
            $('.count_qty .plus').prop('disabled', true); // é–å®šæ‰€æœ‰ count_qty å…§éƒ¨çš„ button
            //$('.count_qty input[type="text"]').prop('disabled', true); // é–å®šæ‰€æœ‰ count_qty å…§éƒ¨çš„ input
        } else {
            // å¦‚æœç¸½å’Œæœªé”åˆ°ä¸Šé™ï¼Œå‰‡è§£é–æ‰€æœ‰æ§ä»¶
            $('.count_qty .plus').prop('disabled', false); // è§£é–æ‰€æœ‰ count_qty å…§éƒ¨çš„ button
            //$('.count_qty input[type="text"]').prop('disabled', false); // è§£é–æ‰€æœ‰ count_qty å…§éƒ¨çš„ input
        }
    }
    // ç¢ºèªèœå–®å­˜å…¥localStorage
    function confirm(type) {
        var data = $("#" + type + "_form").find(".quantity-input").map(function (idx, comp) {
            if (parseInt($(comp).val()) > 0) {
                // è¨˜éŒ„å“é …
                var goods = $(comp).parents(".card-body").eq(0).find("h5").text();
                var qty = parseInt($(comp).val());
                var sugar = $(comp).parents(".card-body").eq(0).find('input[name^="sugar-option-"]:checked').val() ?? "";
                var iced = $(comp).parents(".card-body").eq(0).find('input[name^="ice-option-"]:checked').val() ?? "";
                var price = $(comp).parents(".card-body").eq(0).find('p').text() ?? "";
                if (price !== "") {
                    price = price.replace(/[^\d.]/g, '');
                    price = parseInt(price);
                }
                return { goods: goods, qty: qty, sugar: sugar, iced: iced, price: price }
            }
        }).get();
        localStorage.setItem(type, JSON.stringify(data));
        // æª¢æŸ¥é …ç›®
        let ck_local = 0;
        $("#cart_total_qty").text(localStorage.length);
        $("#" + type + "_form").modal("toggle");
    }
    function OpenModal(type) {
        // å¦‚æœæœ‰é¸å¥½çš„é¤é»ï¼Œå…ˆåŠ ä¸Šå»
        if (localStorage.getItem(type)) {
            jsonString = localStorage.getItem(type);
            order_list = JSON.parse(jsonString);
            // æ¯”å° food_data çš„ keyå€¼ï¼Œå»åŠ ç¸½
            order_list.forEach(function (order_item) {
                var goods_name = order_item.goods;
                // æ‰¾åˆ°åŒ…å«é€™å€‹å­—å…ƒçš„ cardå…ƒä»¶
                var span = $('h5:contains(' + goods_name + ')');
                var input = $(span).closest('.card-body').find('.quantity-input');
                $(input).val(order_item.qty);
                var sugar = $(span).closest('.card-body').find('.option-group[data-option-type="sugar"]');
                if (order_item.sugar !== "") {
                    $(sugar).find('input[type="radio"][value="' + order_item.sugar + '"]').prop('checked', true);
                }
                var iced = $(span).closest('.card-body').find('.option-group[data-option-type="ice"]');
                if (order_item.iced !== "") {
                    $(iced).find('input[type="radio"][value="' + order_item.iced + '"]').prop('checked', true);
                }
            })
            if (type == "drink") {
                fillinDrinkList();
            }
            Sum(type);
        }
        $("#" + type + "_form").modal("toggle");
        $("#cart_total_qty").val(0); //è³¼ç‰©è»Šæ¸…0
    }
    function fillinDrinkList() {
        var listItem = "";
        $("#drink_form").find(".quantity-input").each(function (idx, comp) {
            if (parseInt($(comp).val()) > 0) {
                // å¾è§¸ç™¼äº‹ä»¶çš„å…ƒç´  (ä¾‹å¦‚ + æˆ– - æŒ‰éˆ•) é–‹å§‹ï¼Œæ‰¾åˆ°æœ€å¤–å±¤çš„ .card å®¹å™¨
                const $card = $(comp).closest('.card');
                // 1. å–å¾—é£²æ–™åç¨±
                const drinkName = $card.find('.card-title').text();
                // 2. å–å¾—åƒ¹æ ¼
                // ç§»é™¤ "åƒ¹æ ¼: NT$" ä¸¦è½‰æ›ç‚ºæ•¸å­—
                const priceText = $card.find('.card-price').text();
                const price = parseFloat(priceText.replace('åƒ¹æ ¼: NT$', ''));
                // 3. å–å¾—ç”œåº¦
                // æ‰¾åˆ°ç”œåº¦çµ„ä¸­è¢«é¸ä¸­çš„ radio çš„å€¼
                const sugar = $card.find('input[name^="sugar-option-"]:checked').val();
                const selectedSugar = sugar || 'æœªé¸'; // å¦‚æœæ²’é¸ï¼Œå‰‡é¡¯ç¤º 'æœªé¸'
                // 4. å–å¾—å†°å¡Š
                // æ‰¾åˆ°å†°åº¦çµ„ä¸­è¢«é¸ä¸­çš„ radio çš„å€¼
                const ice = $card.find('input[name^="ice-option-"]:checked').val();
                const selectedIce = ice || 'æœªé¸'; // å¦‚æœæ²’é¸ï¼Œå‰‡é¡¯ç¤º 'æœªé¸'
                // 5.æ•¸é‡
                const quantity = parseInt($(comp).val());
                listItem += `
                    <li>
                        <strong>${drinkName}</strong> - åƒ¹æ ¼: NT$${price}
                        (ç”œåº¦: ${selectedSugar}, å†°å¡Š: ${selectedIce})
                        æ•¸é‡: ${quantity}
                    </li>
                `;
            }
        })
        // å°‡ç”Ÿæˆçš„æ¸…å–®é …ç›®æ·»åŠ åˆ° ul ä¸­
        $('#drink_name').html(listItem);
    }
    // é€å‡ºè¨‚å–®
    function Confirm(buttom) {
        var modal = $(buttom).parents(".modal");
        // æª¢æŸ¥æ˜¯å¦éƒ½æœ‰å¡«
        var order_floor = $("#select_floor").combobox("getValue");
        var order_name = $("#select_name").combobox("getValue");
        var order_food = localStorage.getItem("food");
        var order_drink = localStorage.getItem("drink");
        if (!order_floor || !order_name || !order_food || !order_drink) {
            Swal.fire({
                title: "è«‹å‹™å¿…å¡«å¯«å®Œæ•´",
                icon: "warning"
            });
            return;
        }
        Swal.fire({
            title: "ç¢ºå®šè¦é€å‡ºè¨‚å–®?",
            showCancelButton: true,
            confirmButtonText: "ç¢ºå®š",
        }).then((result) => {
            if (result.isConfirmed) {
                total = JSON.parse(order_drink).map(drink => (drink.price) * (drink.qty)).reduce((accumulator, currentValue) => {
                    return accumulator + currentValue;
                }, 0);
                var form_data = {
                    creatd_at: showDate(new Date()),
                    order_floor: order_floor,
                    order_name: order_name,
                    order_food: order_food,
                    order_drink: order_drink,
                    total: parseInt(150 + total),
                };
                InsertGasData("6æœˆè¡¨å–®å›æ‡‰", form_data);
                Swal.fire("é€å‡ºæˆåŠŸ", "", "success");
                localStorage.clear(); // é€å‡ºå¾Œæ¸…ç©ºç´€éŒ„
                // é—œé–‰modal
                $("#cart_form").modal("toggle");
            }
        });
    }
</script>

</html>