<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>2025/07 福康活動-大暑吃大薯</title>
    <link rel="shortcut icon" type="image/x-icon" href="../../public/TAKO.ico">
    <link rel="stylesheet icon" type="text/css" href="../../public/easyui/metro-orange/easyui.css">
    <link rel="stylesheet icon" type="text/css" href="../../public/bootstrap/bootstrap.min.css">
    <link rel="stylesheet icon" type="text/css" href="../../public/bootstrap/bootstrap-icons.min.css">
    <link rel="stylesheet icon" type="text/css" href="../../public/sweetalert/sweetalert2.min.css">
    <link rel="stylesheet icon" type="text/css" href="../../public/daterangepicker/daterangepicker.css">
    <link rel="stylesheet icon" type="text/css" href="../../public/main/main.css">
    <style>
        body {
            margin: 0;
            font-family: 'Segoe UI', sans-serif;
            background: #fff;
            color: #333;
            font-family: 'Noto Sans CJK TC', sans-serif; /* You might need to import a suitable Chinese font */
        }

        .container {
            max-width: 1000px;
            margin: auto;
            padding: 40px 20px;
            text-align: center;
        }

        h1 {
            font-size: 3em;
            font-weight: bold;
        }

        h1 .highlight {
            color: orange;
        }

        .subtext {
            margin: 10px 0 30px;
            color: #666;
            font-size: 0.95em;
        }

        .order-button {
            background-color: orange;
            color: white;
            border: none;
            padding: 14px 28px;
            font-size: 1em;
            border-radius: 6px;
            cursor: pointer;
        }

        .price-section {
            margin-top: 30px;
            font-size: 1.5em;
            color: orange;
        }

        .stars {
            color: gold;
            margin: 10px 0;
        }

        .features {
            display: flex;
            justify-content: center;
            gap: 40px;
            margin: 40px 0;
            font-size: 0.9em;
            color: #666;
        }

        .features div {
            max-width: 200px;
        }

        .burger-image {
            margin: 40px auto;
            max-width: 500px;
        }

        .burger-image img {
            width: 100%;
            max-width: 100%;
            height: auto;
        }

        .nav-icons {
            display: flex;
            justify-content: space-around;
            margin-top: 60px;
            border-top: 1px solid #eee;
            padding-top: 20px;
        }

        .nav-icons div {
            text-align: center;
            font-size: 0.95em;
            color: #333;
        }

        .nav-icons img {
            height: 36px;
            margin-bottom: 5px;
        }

        .footer {
            font-size: 0.8em;
            color: #999;
            margin-top: 40px;
        }
    </style>
</head>

<body>
    <div class="container">
        <h1><em> <span class="highlight">JULY 22</span> 大暑吃大薯</em></h1>
        <div class="subtext">
            7/21 國際垃圾食物日、7/22 大暑、在大暑這天吃大薯，好好感受垃圾食物的魅力！
        </div>

        <div class="burger-image">
            <img src="https://img.lovepik.com/free-png/20220107/lovepik-summer-fast-food-big-fries-png-image_401243349_wh860.png"
                alt="Burger" style="mouse" />
        </div>

        <div class="features">
            <div>
                <strong>NATURE FIRST FOOD</strong><br />
                Rorem ipsum dolor sit amet, etur advoluptatem voluptatem
            </div>
            <div>
                <strong>HEALTHY FOOD</strong><br />
                Rorem ipsum dolor sit amet, etur advoluptatem voluptatem
            </div>
            <div>
                <strong>GREAT LOCATION</strong><br />
                Rorem ipsum dolor sit amet, etur advoluptatem voluptatem
            </div>
        </div>

        <div class="nav-icons">
            <div>
                🍔<br />Burger
            </div>
            <div>
                🍕<br />Pizza
            </div>
            <div>
                🍞<br />Bread
            </div>
            <div>
                🍗<br />Chicken
            </div>
            <div>
                🍝<br />Pasta
            </div>
            <div>
                🥤<br />Drinks
            </div>
        </div>

        <div class="footer">
            &copy; 2025 Excellent Bugger Food. All rights reserved.
        </div>
    </div>
</body>
<script type="text/javascript" src="../../public/main/main.js"></script>
<script type="text/javascript" src="../../public/easyui/jquery.min.js"></script>
<script type="text/javascript" src="../../public/easyui/jquery.easyui.min.js"></script>
<script type="text/javascript" src="../../public/easyui/locale/easyui-lang-zh_TW.js"></script>
<script type="text/javascript" src="../../public/bootstrap/bootstrap.min.js"></script>
<script type="text/javascript" src="../../public/sweetalert/sweetalert2.min.js"></script>
<script type="text/javascript" src="../../public/daterangepicker/moment.min.js"></script>
<script type="text/javascript" src="../../public/jquery.actual-master/jquery.actual.min.js"></script>
<script type="text/javascript" src="../../public/daterangepicker/daterangepicker.js"></script>
<script type="text/javascript" src="../../public/gas/gas.js"></script>
<script type="text/javascript" src="../../public/animation/anime.min.js"></script>
<script type="text/javascript">
    // 只要重整就是要重新填單
    localStorage.clear();
    // 先跑完加載，再跑自己的fn
    // 讀取圖片
    // $("#logo_drink").attr('src',"../../public/img/20250618/logo_drink.png")
    //-----------------------------------------------------------------------------------------
    // 每行（每個 card-group）顯示的卡片數量
    let group_size = 4;
    //-----------------------------------------------------------------------------------------
    // 食物的讀取
    //-----------------------------------------------------------------------------------------
    let food_html = ""; // 用於累積所有 card-group 的 HTML
    // 外層迴圈：根據每組的數量來迭代，生成多個 card-group
    for (let i = 0; i < food_data.length; i += group_size) {
        let current_card_group_html = `<div class="card-group mb-3">`; // 為每個 card-group 增加底部邊距，使其與下一組有間隔
        // 內層迴圈：處理每個 card-group 中的卡片
        for (let j = 0; j < group_size; j++) {
            let current_index = i + j; // 計算當前卡片的索引
            // 檢查是否還有數據，避免超出 food_data 陣列的範圍
            if (current_index < food_data.length) {
                current_card_group_html += `
                            <div class="card h-100"> <img src="` + url + "public/img/20250618/" + food_data[current_index] + `.png" class="card-img-top food-card-img" alt="...">
                                <div class="card-body">
                                    <h5 class="card-title text-center">` + food_data[current_index] + `</h5>
                                    <div class="input-group justify-content-center mt-2 count_qty">
                                        <button class="btn btn-outline-secondary" type="button" onClick="Minus_qty(this,'food')" > - </button>
                                        <input type="text" class="form-control text-center quantity-input" disabled placeholder="" aria-label="數量"  value=0 style="max-width: 60px;" >
                                        <button class="btn btn-outline-secondary plus" type="button" onClick="Plus_qty(this,'food')"> + </button>
                                    </div>
                                </div>
                            </div>
                        `;
            } else {
                // 如果這行不足 group_size 個卡片，可以用空的卡片補齊，
                // 這樣可以讓 card-group 保持每列的寬度一致。
                // 這對於 card-group 很重要，因為它會自動調整內部卡片的寬度。
                current_card_group_html += `<div class="card card-placeholder invisible"></div>`; // 使用 invisible 讓其不顯示但佔據空間
            }
        }
        current_card_group_html += `</div>`; // 結束當前 card-group 的 div
        food_html += current_card_group_html; // 將完成的 card-group 加入總 HTML 字符串
    }
    $("#food_cards").append(food_html);
    //-----------------------------------------------------------------------------------------
    // 飲料的讀取
    //-----------------------------------------------------------------------------------------
    // 第一層迴圈：遍歷每個飲料類別
    var drinkCategories = Object.keys(drink_data);
    var drink_html = "";
    var key = 1;
    for (let i = 0; i < drinkCategories.length; i++) {
        const categoryName = drinkCategories[i];
        const drinksInThisCategory = drink_data[categoryName];
        drink_html += `                  
                                <div class="card drink-category" >
                                    <div class="card-header">
                                        <button class="btn btn-link btn-block text-left" type="button" data-toggle="collapse" data-target="#collapse_${i}" aria-expanded="true" aria-controls="collapseOne">
                                        〉${categoryName}
                                        </button>
                                    </div>
                                    <div id="collapse_${i}" class="collapse" aria-labelledby="headingOne" data-parent="#accordion_drink">
                                    `;
        // 將該類別下的所有飲品名稱轉換成陣列，方便使用索引進行分組
        const drinkNamesArray = Object.keys(drinksInThisCategory);
        const cardsPerRow = 4; // 每組顯示的卡片數量
        for (let j = 0; j < drinkNamesArray.length; j++) {
            // 每當 j 是 cardsPerRow 的倍數時（包括 j=0），就開始一個新的 card-group
            if (j % cardsPerRow === 0) {
                // 如果不是第一個 card-group，先結束前一個
                if (j !== 0) {
                    // **補齊剩餘的佔位卡片**
                    drink_html += `</div>`; // 結束上一個 card-group
                }
                // 開始新的 card-group，並增加底部邊距
                drink_html += `<div class="card-group mb-3">`;
            }
            const drinkName = drinkNamesArray[j];
            const drinkDetails = drinksInThisCategory[drinkName];
            drink_html += `
                        <div class="card h-100">
                            <div class="card-body">
                                <h5 class="card-title text-center">${drinkName}</h5>
                                <p class="card-price text-center">價格: NT$${drinkDetails.price}</p>`;
            // 檢查是否甜度冰塊正常
            var ice = ['正常冰', '少冰', '去冰', '溫'];
            var sugar = ['正常糖', '半糖', '微糖', '無糖'];
            if (drinkDetails.normal_only === 1) {
                drink_html += `<div class="option-group" data-option-type="sugar">
                                            <input type="radio" id="sugar-normal-${key}" name="sugar-option-${key}" value="甜度固定" class="hidden-radio">
                                            <label for="sugar-normal-${key}" class="option-label-radio">甜度固定</label>
                                        </div>
                                        <div class="option-group" data-option-type="ice">
                                            <input type="radio" id="ice-normal-${key}" name="ice-option-${key}" value="冰塊固定" class="hidden-radio">
                                            <label for="ice-normal-${key}" class="option-label-radio">冰塊固定</label>
                                        </div>`;
            } else {
                drink_html += `
                                        <div class="option-group" data-option-type="sugar">
                                            <input type="radio" id="sugar-normal-${key}" name="sugar-option-${key}" value="正常糖" class="hidden-radio">
                                            <label for="sugar-normal-${key}" class="option-label-radio">正常糖</label>
                                            <input type="radio" id="sugar-half-${key}" name="sugar-option-${key}" value="半糖" class="hidden-radio">
                                            <label for="sugar-half-${key}" class="option-label-radio">半糖</label>
                                            <input type="radio" id="sugar-slight-${key}" name="sugar-option-${key}" value="微糖" class="hidden-radio">
                                            <label for="sugar-slight-${key}" class="option-label-radio">微糖</label>
                                            <input type="radio" id="sugar-none-${key}" name="sugar-option-${key}" value="無糖" class="hidden-radio">
                                            <label for="sugar-none-${key}" class="option-label-radio">無糖</label>
                                        </div>
                                        <div class="option-group" data-option-type="ice">`;
                if (drinkDetails.onIy_iced === 1 || drinkDetails.onIy_hot === 0) {
                    drink_html += `    <input type="radio" id="ice-normal-${key}" name="ice-option-${key}" value="正常冰" class="hidden-radio">
                                            <label for="ice-normal-${key}" class="option-label-radio">正常冰</label>
                                            <input type="radio" id="ice-less-${key}" name="ice-option-${key}" value="少冰" class="hidden-radio">
                                            <label for="ice-less-${key}" class="option-label-radio">少冰</label>
                                            <input type="radio" id="ice-no-${key}" name="ice-option-${key}" value="去冰" class="hidden-radio">
                                            <label for="ice-no-${key}" class="option-label-radio">去冰</label>`;
                } else if (drinkDetails.onIy_hot === 1 || drinkDetails.onIy_iced === 0) {
                    drink_html += `
                                            <input type="radio" id="sugar-none-${key}" name="sugar-option-${key}" value="溫" class="hidden-radio">
                                            <label for="sugar-none-${key}" class="option-label-radio">溫</label>`;
                }
                drink_html += ` 
                        </div>
                                    <div class="count_qty"> <div class="input-group justify-content-center mt-2">
                                            <button class="btn btn-outline-secondary add_text" type="button" onClick="Minus_qty(this,'drink')" > - </button>
                                            <input type="text" class="form-control text-center quantity-input" placeholder="" aria-label="數量" value="0" style="max-width: 60px;" id="quantity-input-drink-${key}">
                                            <button class="btn btn-outline-secondary add_text" type="button" onClick="Plus_qty(this,'drink')" > + </button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        `;
            }
            key++;
        }
        // **迴圈結束後，處理最後一個 card-group 的補齊問題**
        // 計算最後一個 card-group 還差多少個卡片
        const remaining_cards = drinkNamesArray.length % cardsPerRow;
        if (remaining_cards !== 0) { // 如果最後一行不是滿的
            const placeholders_to_add = cardsPerRow - remaining_cards;
            for (let k = 0; k < placeholders_to_add; k++) {
                drink_html += `<div class="card card-placeholder"></div>`;
            }
        }
        // 確保每個類別的最後一個 card-group 被正確關閉
        if (drinkNamesArray.length > 0) { // 只有當這個類別有飲品時才需要關閉 card-group
            drink_html += `</div>`; // 結束最後一個 card-group
        }
        drink_html += `</div></div>`; // 結束 drink-category
    }
    $("#drink_cards").append(drink_html);
    // 如果有加減項目，就把選過的品項寫上去
    $(".add_text").on("click", function () {
        // 先檢查是否有選甜度冰塊
        var sugar_ck_comp = $(this).closest('.card').find('input[name^="sugar-option-"]:checked').val();
        var ice_ck_comp = $(this).closest('.card').find('input[name^="ice-option-"]:checked').val();
        if (!sugar_ck_comp || !ice_ck_comp) {
            Swal.fire({
                title: "請先選擇甜度冰塊",
                icon: "warning"
            });
            // 把值歸零
            $(this).siblings("input").val(0);
            return;
        }
        fillinDrinkList();
    })
    //-----------------------------------------------------------------------------------------
    // 重製表單狀態
    //-----------------------------------------------------------------------------------------
    // 監聽所有具有 'modal' 類別的元素，當它們觸發 'hidden.bs.modal' 事件時
    $('.modal').on('hidden.bs.modal', function () {
        $('.count_qty input[type="text"]').prop('disabled', false); // 鎖定所有 count_qty 內部的 input
        $('.count_qty input[type="text"]').val(0); // 鎖定所有 count_qty 內部的 input
        // 2. 展開 Modal 內部所有的 Accordion 項目
        // 找到 Modal 內部所有具有 'accordion-collapse' 類別的摺疊內容區塊
        $(this).find('.collapse').each(function () {
            $(this).removeClass("show");
        });
        // 清空選取的 radio
        $('.hidden-radio:checked').each(function (idx, val) {
            $(val).prop("checked", false);
        })
    });
    //-----------------------------------------------------------------------------------------
    // 購物車的開啟
    //-----------------------------------------------------------------------------------------
    $('#cart_form').on('show.bs.modal', function (event) {
        var total = 0;
        /*---------------------------------------------*/
        // 讀取列表，並依照建立時間先排序
        /*---------------------------------------------*/
        var form_data = GetGasData("6月表單回應");
        // 將資料轉化為可讀取的資料
        var [header, ...data] = form_data;
        form_data = data
            .map((row) =>
                header.reduce((acc, key, index) => ({ ...acc, [key]: row[index] }), {})
            );
        const remainingMembers = {};
        const reportedMembersByFloor = {};
        // 1. 建立已報到人員的快速查找結構
        // 遍歷 form_data，將已報到的人員按樓層歸類
        form_data.forEach(person => {
            let floorKey = person.order_floor;
            if (!reportedMembersByFloor[floorKey]) {
                reportedMembersByFloor[floorKey] = new Set(); // 使用 Set 進行高效查找
            }
            reportedMembersByFloor[floorKey].add(person.order_name);
        });
        // 2. 遍歷 member_list，找出每個樓層剩餘的人
        for (const floorKey in member_list) {
            if (member_list.hasOwnProperty(floorKey)) {
                const floorMembers = member_list[floorKey];
                const currentReportedMembers = reportedMembersByFloor[floorKey] || new Set(); // 如果該樓層沒有人報到，則為空 Set
                const remainingInThisFloor = [];
                floorMembers.forEach(member => {
                    if (!currentReportedMembers.has(member)) {
                        remainingInThisFloor.push(member);
                    }
                });
                remainingMembers[floorKey] = remainingInThisFloor;
            }
        }
        // 比對一下每個樓層剩餘的人數
        // 依照剩餘人數準備 data
        let loadData_floor = [];
        for (let floor in remainingMembers) {
            let data = {};
            data.id = floor;
            data.text = floor;
            loadData_floor.push(data);
        }
        $("#select_floor").combobox({
            required: true,
            editable: false,
            panelHeight: 'auto',
            panelMaxHeight: '335',
            valueField: 'id',
            textField: 'text',
            data: loadData_floor,
            onChange: function (newValue, oldValue) {
                if (newValue !== oldValue) {
                    $("#select_name").combobox("setValue", "");
                    data = remainingMembers[newValue].map((x) => { return { id: x, text: x } });
                }
                $("#select_name").combobox("loadData", data);
                if (newValue == "二樓") {
                    $("#order_list_ul").append(`<tr><td colspan=2 id="budget">個人預算剩餘：${233 - total}</td></tr>`);
                } else {
                    if ($("#budget").length > 0) {
                        $("#budget").remove();
                    }
                }
            }
        })
        $("#select_name").combobox({
            required: true,
            editable: false,
            panelHeight: 'auto',
            panelMaxHeight: '250',
            valueField: 'id',
            textField: 'text',
            idField: "id",
            textField: "text",
        })
        /*---------------------------------------------*/
        // 點餐清單
        /*---------------------------------------------*/
        var html_order = `
                <tr>
                    <td class="w-50">閣樓上的鹹派</td>
                    <td class="w-50">日出茶太</td>
                </tr>
                <tr>
                `;
        html_order += `<td class="w-50"> `;
        if (localStorage.getItem("food")) {
            var food_list = JSON.parse(localStorage.getItem("food"));
            food_list.forEach(food => {
                html_order += `
                            <li>
                                <strong>${food.goods}</strong> *${food.qty}
                            </li>
                        `;
            });
            total += 150;
        }
        html_order += `</td> `;
        html_order += `<td class="w-50"> `;
        if (localStorage.getItem("drink")) {
            var drink = JSON.parse(localStorage.getItem("drink"));
            drink.forEach(drink => {
                html_order += `
                            <li>
                                <strong>${drink.goods}</strong> - 價格: NT$${drink.price}
                                (甜度: ${drink.sugar}, 冰塊: ${drink.iced})
                                數量: ${drink.qty}
                            </li>
                        `;
                total += drink.price;
            });
        }
        html_order += `</td><tr> `;
        // 總和金額
        html_order += `<tr><td colspan="2">總金額：${total}</td></tr>`;
        $("#order_list_ul").html(html_order);
    })
    //     }
    // )
    //-----------------------------------------------------------------------------------------
    // 一些好用的 function
    //-----------------------------------------------------------------------------------------
    // 增加數量    
    function Minus_qty(btn, type) {
        var input = $(btn).next('.quantity-input');
        var value = parseInt($(input).val());
        $(input).val(value - 1 < 0 ? 0 : value - 1);
        Sum(type);
    }
    // 減少數量
    function Plus_qty(btn, type) {
        var input = $(btn).prev('.quantity-input');
        var value = parseInt($(input).val());
        $(input).val(value + 1);
        Sum(type);
    }
    // 減少數量
    function Sum(type) {
        // 取得所有的數字
        let totalQuantity = 0;
        $('.quantity-input').each(function () {
            // 取得每個 input 的值
            let quantity = parseInt($(this).val()); // 使用 parseInt 將值轉換為整數
            // 檢查轉換後的數字是否有效 (不是 NaN)
            if (!isNaN(quantity)) {
                totalQuantity += quantity; // 加到總和中
            }
        });
        var max_count = {
            "food": 2,
            "drink": 9999,
        };
        if (totalQuantity >= max_count[type]) {
            // 如果總和達到或超過上限，鎖定所有相關控件
            $('.count_qty .plus').prop('disabled', true); // 鎖定所有 count_qty 內部的 button
            //$('.count_qty input[type="text"]').prop('disabled', true); // 鎖定所有 count_qty 內部的 input
        } else {
            // 如果總和未達到上限，則解鎖所有控件
            $('.count_qty .plus').prop('disabled', false); // 解鎖所有 count_qty 內部的 button
            //$('.count_qty input[type="text"]').prop('disabled', false); // 解鎖所有 count_qty 內部的 input
        }
    }
    // 確認菜單存入localStorage
    function confirm(type) {
        var data = $("#" + type + "_form").find(".quantity-input").map(function (idx, comp) {
            if (parseInt($(comp).val()) > 0) {
                // 記錄品項
                var goods = $(comp).parents(".card-body").eq(0).find("h5").text();
                var qty = parseInt($(comp).val());
                var sugar = $(comp).parents(".card-body").eq(0).find('input[name^="sugar-option-"]:checked').val() ?? "";
                var iced = $(comp).parents(".card-body").eq(0).find('input[name^="ice-option-"]:checked').val() ?? "";
                var price = $(comp).parents(".card-body").eq(0).find('p').text() ?? "";
                if (price !== "") {
                    price = price.replace(/[^\d.]/g, '');
                    price = parseInt(price);
                }
                return { goods: goods, qty: qty, sugar: sugar, iced: iced, price: price }
            }
        }).get();
        localStorage.setItem(type, JSON.stringify(data));
        // 檢查項目
        let ck_local = 0;
        $("#cart_total_qty").text(localStorage.length);
        $("#" + type + "_form").modal("toggle");
    }
    function OpenModal(type) {
        // 如果有選好的餐點，先加上去
        if (localStorage.getItem(type)) {
            jsonString = localStorage.getItem(type);
            order_list = JSON.parse(jsonString);
            // 比對 food_data 的 key值，去加總
            order_list.forEach(function (order_item) {
                var goods_name = order_item.goods;
                // 找到包含這個字元的 card元件
                var span = $('h5:contains(' + goods_name + ')');
                var input = $(span).closest('.card-body').find('.quantity-input');
                $(input).val(order_item.qty);
                var sugar = $(span).closest('.card-body').find('.option-group[data-option-type="sugar"]');
                if (order_item.sugar !== "") {
                    $(sugar).find('input[type="radio"][value="' + order_item.sugar + '"]').prop('checked', true);
                }
                var iced = $(span).closest('.card-body').find('.option-group[data-option-type="ice"]');
                if (order_item.iced !== "") {
                    $(iced).find('input[type="radio"][value="' + order_item.iced + '"]').prop('checked', true);
                }
            })
            if (type == "drink") {
                fillinDrinkList();
            }
            Sum(type);
        }
        $("#" + type + "_form").modal("toggle");
        $("#cart_total_qty").val(0); //購物車清0
    }
    function fillinDrinkList() {
        var listItem = "";
        $("#drink_form").find(".quantity-input").each(function (idx, comp) {
            if (parseInt($(comp).val()) > 0) {
                // 從觸發事件的元素 (例如 + 或 - 按鈕) 開始，找到最外層的 .card 容器
                const $card = $(comp).closest('.card');
                // 1. 取得飲料名稱
                const drinkName = $card.find('.card-title').text();
                // 2. 取得價格
                // 移除 "價格: NT$" 並轉換為數字
                const priceText = $card.find('.card-price').text();
                const price = parseFloat(priceText.replace('價格: NT$', ''));
                // 3. 取得甜度
                // 找到甜度組中被選中的 radio 的值
                const sugar = $card.find('input[name^="sugar-option-"]:checked').val();
                const selectedSugar = sugar || '未選'; // 如果沒選，則顯示 '未選'
                // 4. 取得冰塊
                // 找到冰度組中被選中的 radio 的值
                const ice = $card.find('input[name^="ice-option-"]:checked').val();
                const selectedIce = ice || '未選'; // 如果沒選，則顯示 '未選'
                // 5.數量
                const quantity = parseInt($(comp).val());
                listItem += `
                    <li>
                        <strong>${drinkName}</strong> - 價格: NT$${price}
                        (甜度: ${selectedSugar}, 冰塊: ${selectedIce})
                        數量: ${quantity}
                    </li>
                `;
            }
        })
        // 將生成的清單項目添加到 ul 中
        $('#drink_name').html(listItem);
    }
    // 送出訂單
    function Confirm(buttom) {
        var modal = $(buttom).parents(".modal");
        // 檢查是否都有填
        var order_floor = $("#select_floor").combobox("getValue");
        var order_name = $("#select_name").combobox("getValue");
        var order_food = localStorage.getItem("food");
        var order_drink = localStorage.getItem("drink");
        if (!order_floor || !order_name || !order_food || !order_drink) {
            Swal.fire({
                title: "請務必填寫完整",
                icon: "warning"
            });
            return;
        }
        Swal.fire({
            title: "確定要送出訂單?",
            showCancelButton: true,
            confirmButtonText: "確定",
        }).then((result) => {
            if (result.isConfirmed) {
                total = JSON.parse(order_drink).map(drink => (drink.price) * (drink.qty)).reduce((accumulator, currentValue) => {
                    return accumulator + currentValue;
                }, 0);
                var form_data = {
                    creatd_at: showDate(new Date()),
                    order_floor: order_floor,
                    order_name: order_name,
                    order_food: order_food,
                    order_drink: order_drink,
                    total: parseInt(150 + total),
                };
                InsertGasData("6月表單回應", form_data);
                Swal.fire("送出成功", "", "success");
                localStorage.clear(); // 送出後清空紀錄
                // 關閉modal
                $("#cart_form").modal("toggle");
            }
        });
    }
</script>

</html>